<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <meta name="format-detection" content="telephone=no">
    <title>ふたマキ</title>
    <link rel="stylesheet" href="/css/style.css">
    <!-- <link rel="icon" href="favicon.ico"> -->
</head>
<body>
    <h1>ふたマキ</h1>
    <div>
        <p>
            某掲示板ブラウザです。
        </p>
        <ul>
            <li class="checked" id="futamaki-bin-link"><a href="/futamaki/">実行ファイル</a></li>
            <li class="checked"><a href="https://github.com/azumyar/futaba-makimoki">ソースコード</a></li>
        </ul>

        <h2>動作環境</h2>
        <ul>
            <li class="checked">Windows 10(x86/x64)ARMは知りません</li>
            <li class="checked">.NET Framework 4.7.2以上</li>
            <li class="checked"><a href="https://www.microsoft.com/ja-jp/download/details.aspx?id=48145">Visual C++ Redistributable for Visual Studio 2015</a></li>
        </ul>

        <h3>インストールについて</h3>
        <p>
            ダウンロードしたZIPを適当なディレクトリに展開してください。futamaki.exeが実行ファイルです。
        </p>

        <h3>アンインストールについて</h3>
        <p>
            ふたマキは標準で%userprofile%\Documents\FutaMakiと%appdata%\FutaMakiにファイルを生成します。アンインストール時はこれらのフォルダも削除してください。レジストリは使用していません。
        </p>
    </div>

    <div id="task-section">
        <h2>リリースに向けて</h2>
        <h3>優先実装機能</h3>
        <ul>
            <li>スレ内検索を途中で放置しているのでちゃんと実装</li>
            <li>設定画面に板追加機能を追加</li>
            <li>スレ/レス削除の画像消去オプション</li>
            <li>ショートカット―の設定外だし</li>
        </ul>

        <h3>既知の問題点</h3>
        <ul>
            <li>動画再生中にメディア画面を閉じようとすると高確率でフリーズする</li>
            <li>検索を開いた状態で別の板に移動して戻ってくると閉じている(画面上閉じているだけで入力は生きています)</li>
        </ul>

        <h3>やれたらいいな</h3>
        <ul>
            <li>もうすぐ落ちるスレをカタログに表示</li>
            <li>多重通信を行わないようにブロックしたほうがいいかな…</li>
            <li>起動時の画面をちゃんと整理したい</li>
            <li>トースト機能の強化</li>
            <li>カタログ部分を非表示にしてスレッドが面を全体化するレイアウト</li>
            <li>カタログのソートとモードを保存</li>
        </ul>

        <h3>やるきぜろ</h3>
        <ul>
            <li>手書き</li>
        </ul>

        <h3>Done</h3>
        <ul>
            <li class="checked">
                period.05 バグ修正
                <ul>
                    <li class="checked">メディアビューで右クリックするとクリックしても閉じなくなる問題を修正</li>
                    <li class="checked">差分JSONにそうだねが乗ってくるようになったためそうだね送信後の更新を全更新から設定依存に変更</li>
                </ul>
            </li>
            <li class="checked">
                period.04 マイグレ処理を作ったので設定回りの簡単なものを消化
                <ul>
                    <li class="checked">題名，おなまえ，メールアドレスを記憶させるオプション</li>
                    <li class="checked">隔離スレッドをカタログに表示させるオプション</li>
                    <li class="checked">投稿ビュー部分にマウスエンターで表示、マウスリーブで半透明みたいな実装</li>
                    <li class="checked">投稿ビューの最小/最大表示サイズを設定</li>
                    <li class="checked">カタログ検索でヒットしたスレ→ヒットしないスレの順番に表示するオプション</li>
                </ul>
            </li>
            <li class="checked">
                period.03 スキマ時間でサクっと実装できるものを消化
                <ul>
                    <li class="checked">ホイールスクロールで更新</li>
                    <li class="checked">スレの一番上や一番下に行ける何か</li>
                </ul>
            </li>
            <li class="checked">
                period.02 間に合わなかったGIFアニメとx64ネイティブ実行に対応
                <ul>
                    <li class="checked">アニメーションGIFの再生</li>
                    <li class="checked"><del>WebPのライブラリがx86オンリーになってるので自前で再実装する</del>勘違い.NET 4.5のビルドオプションが原因</li>
                    <li class="checked">メディアビュー@画像で右上の✖ボタンは遠いのでクリックとかで閉じたい</li>
                </ul>
            </li>
            <li class="checked">
                period.01 ファーストリリース
                <ul>
                    <li class="checked">ID NG機能</li>
                    <li class="checked">NGコメント機能</li>
                    <li class="checked">コメント非表示機能</li>
                    <li class="checked">NG画像機能→精度に難がある気がするけどこんなものなのかな？あとちょう重い</li>
                    <li class="checked">設定画面</li>
                    <li class="checked">ショートカットキー</li>
                    <li class="checked">
                        画像の保存
                        <ul>
                            <li class="checked">静止画の保存</li>
                            <li class="checked">動画の保存</li>
                        </ul>
                    </li>
                    <li class="checked">現在の開いているスレッドの状態の保存</li>
                    <li class="checked">スレ/レス画像ファイル名を引用するためのなにがし</li>
                    <li class="checked">クリップボードから画像添付</li>
                    <li class="checked"><del>DPI付きJPEG画像が小さく表示される(PNGは対応済み、WebPは知らない)</del>ImageのWidth/HeightにImageSourceのサイズをバインドすればよかったぽい</li>
                    <li class="checked">画像キャッシュ読み込み時に別プロセスが握っているとクラッシュする→数回試行するように修正したい</li>
                    <li class="checked">エラー表示強化</li>        
                    <li class="checked">アプリの自動アップデート確認機能</li>
                </ul>
            </li>
        </ul>
    </div>

    <div id="backlog-section">
        <h2>バックログ</h2>
        <ul>
            <li>カタログ強調ワード/画像機能</li>
            <li>カラー・フォント設定ファイル外だし</li>
            <li>
                音声読み上げ
                <ul>
                    <li>WindowsのAPIでやる？</li>
                    <li>棒読みちゃん連携する？(棒読みちゃんはボイロ連携できる)</li>
                </ul>
            </li>
            <li>スレの自動更新関係</li>
            <li>ListBoxのスクロール量を変更(できるのか？)</li>
            <li>ListBoxのホイールクリックでオートスクロールモードに(できるのか？)</li>
            <li>タスクバーを隠す設定にしてウィンドウを最大化するとタスクバーが出てこない(SourceTreeも出てこないしWindowChromeの問題？)</li>
            <li>引用ポップアップをツールチップじゃなくてウィンドウにしたい、引用の引用が表示できるように</li>
            <li>レスの引用カウント表示と引用先レスのポップアップ表示</li>
            <li>カタログのタイトル文字数を設定できる機能</li>
            <li>右下にスレ画表示する機能(誤爆防止)</li>
            <li>開いたスレの履歴</li>
            <li>なーされたスレをキャッシュしている場合以前の書き込みを表示できる機能</li>
            <li>カタログのソートを1クリックでできるように</li>
        </ul>
    </div>

    <div id="qa-section">
        <h2>QA</h2>

        <h3>削除キーの平文保存</h3>
        <p>平文で保存しています。重要なパスワードを設定することはないとは思いますが、取り扱いには注意していください。イタチごっこになるため暗号化する予定はありません。</p>

        <h3>設定ファイル(など)の保存場所変更について</h3>
        <p>ポータブル化したい等の要望に対応するためふたマキは出力ファイル場所の制御が可能です。</p>
        <p>Conf.d\windows.exe.json.sampleをConf.d\windows.exe.jsonにリネームしてテキストエディタ(など)で編集します。UTF-8で保存してください。中身のJSONフォーマットが何かについてはここでは説明しません。</p>
        <table>
            <tr>
                <td>version</td>
                <td>固定値</td>
            </tr>
            <tr>
                <td>single-user-data</td>
                <td>true/false，trueにすると%appdata%配下ではなくexeファイル階層にSingleUserディレクトリを作りその配下にファイルを出力します</td>
            </tr>
            <tr>
                <td>single-user-config</td>
                <td>true/false，trueにすると%userprofile%\Documents配下ではなくexeファイル階層にSingleUserディレクトリを作りその配下にファイルを出力します</td>
            </tr>
            <tr>
                <td>custom-data-path</td>
                <td>ディレクトリパスを指定。%appdata%配下ではなく指定したパスにファイルを出力します。(single-user-dataがtrueの場合有効)</td>
            </tr>
            <tr>
                <td>custom-config-path</td>
                <td>ディレクトリパスを指定。%userprofile%\Documents配下ではなく指定したパスにファイルを出力します。(single-user-configがtrueの場合有効)</td>
            </tr>
        </table>

        <h3>ショートカットキー</h3>
        <p>メインウィンドウ</p>
        <table>
            <tr>
                <td>Ctrl+U</td>
                <td>スレッド更新</td>
            </tr>
            <tr style="display: none;">
                <td>Ctrl+F</td>
                <td>スレッド検索</td>
            </tr>
            <tr>
                <td>Ctrl+Enter</td>
                <td>レス投稿ビュー表示</td>
            </tr>
            <tr>
                <td>Ctrl+Alt+U</td>
                <td>カタログ更新</td>
            </tr>
            <tr style="display: none;"></tr>
                <td>Ctrl+Alt+F</td>
                <td>カタログ検索</td>
            </tr>
            <tr style="display: none;">
                <td>Ctrl+Alt+S</td>
                <td>カタログソートメニュー展開</td>
            </tr>

            <tr>
                <td>Ctrl+Alt+M</td>
                <td>カタログビューWrap/Listモード切替</td>
            </tr>
            <tr>
                <td>Ctrl+Alt+Enter</td>
                <td>新規スレッド投稿ビュー表示</td>
            </tr>
            <tr>
                <td>F5</td>
                <td>スレッド更新</td>
            </tr>

            <tr>
                <td>Ctrl+F5</td>
                <td>スレッド更新</td>
            </tr>
            <tr>
                <td>Ctrl+Alt+F5</td>
                <td>カタログ更新</td>
            </tr>
            <tr>
                <td>Ctrl+W</td>
                <td>今見ているスレッドを閉じる</td>
            </tr>

            <tr>
                <td>Ctrl+F4</td>
                <td>今見ているスレッドを閉じる</td>
            </tr>
        </table>

        <p>投稿ビュー</p>
        <table>
            <tr>
                <td>Ctrl+Ente</td>
                <td>スレッド作成/レス投稿</td>
            </tr>
            <tr>
                <td>Ctrl+P</td>
                <td>スレ/レス画像選択ダイアログ</td>
            </tr>

            <tr>
                <td>Ctrl+L</td>
                <td>あぷ小アップロード選択ダイアログ</td>
            </tr>
            <tr>
                <td>Ctrl+D</td>
                <td>今書いている内容を削除</td>
            </tr>
            <tr>
                <td>Ctr+Shift+V</td>
                <td>クリップボードのURL，画像データから投稿ビューに添付</td>
            </tr>

            <tr>
                <td>Esc</td>
                <td>閉じる</td>
            </tr>
        </table>

        <h3>クリップボードからの投稿ビュー添付機能について</h3>
        <p>クリップボードに画像データが存在している場合JPEG形式で添付します。JPEGの圧縮品質は設定画面で編集可能です。</p>
        <p>クリップボードのテキストがURLかつサイズが3M以下かつMIMEタイプがサポート対象の場合ダウンロードして添付します。画像フォーマットの変更は行いません。</p>

        <h3>画像NG機能について注意</h3>
        <p>画像のNG判定はpHashでハッシュ化しハッシュ値の比較結果が閾値(閾値は設定画面で変更可能)をした回った場合類似画像としてNG処理を行います。これにより同じ画像を再圧縮した、サイズ変更したので見た目が同じでもファイルハッシュが違うケースにも対応可能ですが、pHashのハッシュ化処理はそこそこ重たいためNG画像を登録していない場合動作しないようになっています。NG画像を登録して動作が重たくなった場合PCがスペック不足の可能性があります。</p>
    </div>

    <div id="contact-section">
        <h2>連絡先</h2>
        <ul>
            <li class="checked"><a href="https://marshmallow-qa.com/yarukizero_dev">マシュマロ</a></li>
        </ul>

        <h3>返信</h3>
        <p>
            <q>
                &gt;カタログの非表示がほしい…！<br />
                &gt;あとカタログのソートの種類を記憶できるように<br />
            </q>
            実装予定タスクには入っていますがまだ着手できていません。もうしばらくお待ちください。
        </p>
        <p>
            <q>
                &gt;スレの一番上や一番下に行ける何かが欲しいです<br />
            </q>
            了解致した。バックログに追加しておきます。
        </p>
        <p>
            <q>
                &gt;す、すいません･･･中瓶鯖が過労死したんで<br />
                &gt;回復まで面倒で申し訳ないですが大瓶使っていただければ<br />
                <br />
                &gt;塩辛瓶中の人<br />
            </q>
            復旧されたようで本当にお疲れ様です…またお世話になります！
        </p>

        <p>
            <q>
                &gt;&gt;うーんどうしましょうね…ふたば外はあまり使いたくなく<br />
                &gt;もちろん塩辛瓶やってる間はって事になりますが、使って頂いて構いません。<br />
                &gt;ただトラフィックが増えてたまに落ちる事があるのはご容赦頂ければ。<br />
                &gt;<br />
                &gt;塩辛瓶中の人<br />
            </q>
            ありがとうございます！！まだまだβリリースは続く予定ですので利用させていただきます。
        </p>

        <p>
            <q>
                &gt;逆あいまい検索と言えばいいんでしょうかね<br />
                &gt;例えばスレ内のレス番号にマウスオーバーしたらそのレスを引用したレスを表示してくれるような機能です<br />
                &gt;ふたクロだと「各レスへの返信数と引用先を表示」って機能です<br />
            </q>
            把握しました。引用ポップアップ実装時に実装しようと思いましたが、いい感じのアルゴリズムを思いつかなかったので保留になっています。<br />
            初回リリースには間に合わないかもしれませんが実装したいですね。
        </p>

         <p>
             <q>
                 &gt;スレ画だけの問題なのかわからないけど画像表示がやけに小さくなって拡大するとガビガビになります<br />
            </q>
            多分DPI付きのJEPG画像じゃないでしょうか？DPIが解釈されてしまい原寸で表示される問題があります。
        </p>
    </div>
<script>
// 最新版のリンクを張る
// IEは面倒見なくていいよね…
if(fetch && String.prototype.padStart) {
    fetch("https://dev.yarukizero.net/futamaki-version-v1.py")
        .then((response) => {
            return response.json();
        })
        .then((json) => {
            const target = document.getElementById("futamaki-bin-link");
             const a = document.createElement("a");
            a.setAttribute("href", json.url);
            a.textContent = "period." + json.period.toString().padStart(2, 0);
            target.append("(最新:", a, ")");
        });
}
</script>
</body>
</html>
